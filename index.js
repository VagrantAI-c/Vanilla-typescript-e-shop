var app=function(e){"use strict";class t{constructor(e,t,n){this.imageUrl=e,this.label=t,this.price=n}}const n=[new t(i(),"Ferrari",5e5),new t(i(),"Lamborghini",499e3),new t(i(),"Kawasaki",1e5),new t(i(),"Samurai",99e3),new t(i(),"Gucci",5e3),new t(i(),"Tesla",1e4),new t(i(),"Boeing",1e6),new t(i(),"S7",9e5)];function i(){return"https://via.placeholder.com/"+Math.floor(600*Math.random()+400)}function r(e){const t=[...""+e],n=t.length-1;return t.map((e,t)=>t!==n&&(n-t)%3==0?e+",":e).join("")+"$"}function a(e,t){const n=(t||document).querySelector(`[${e}]`);if(!n)throw new Error(`Expected "[${e}]" to be available in DOM`);return n}var s;!function(e){e.MASONRY_CONTAINER="masonryContainer",e.CART_ITEMS_CONTAINER="cartItemsContainer",e.CART_SIDEBAR="cartSidebar",e.CART_SUMMARY_LABEL="cartSummaryLabel",e.CART_QUANTITY_LABEL="cartQuantityLabel",e.CART_ITEM_TEMPLATE="cartItem",e.CART_ITEM_WRAPPER="cartItemWrapper",e.CART_ITEM_IMAGE="cartItemImage",e.CART_ITEM_NAME_LABEL="cartItemNameLabel",e.CART_ITEM_PRICE_LABEL="cartItemPriceLabel",e.CART_ITEM_REMOVE_BUTTON="cartItemRemoveButton",e.VEHICLE_CARD_TEMPLATE="vehicleCard",e.VEHICLE_CARD_PURCHASE_BUTTON="vehicleCardPurchaseButton",e.VEHICLE_CARD_IMAGE="vehicleCardImage",e.VEHICLE_CARD_NAME_LABEL="vehicleCardNameLabel",e.VEHICLE_CARD_PRICE_LABEL="vehicleCardPriceLabel"}(s||(s={}));class E{constructor(e){this.cartStore=e}render(e,t){const n=a(s.VEHICLE_CARD_TEMPLATE).content.cloneNode(!0);a(s.VEHICLE_CARD_IMAGE,n).setAttribute("src",e.imageUrl),a(s.VEHICLE_CARD_NAME_LABEL,n).textContent=e.label,a(s.VEHICLE_CARD_PRICE_LABEL,n).textContent=r(e.price),a(s.VEHICLE_CARD_PURCHASE_BUTTON,n).addEventListener("click",this.purchase.bind(this,e)),t.appendChild(n)}purchase(e){this.cartStore.add(e)}}class c{constructor(e,t){this.item=e,this.cartStore=t,this.containerElementRef=null,this.boundEmitRemoveFn=this.emitRemove.bind(this,this.item)}render(e){const t=a(s.CART_ITEM_TEMPLATE).content.cloneNode(!0);this.containerElementRef=a(s.CART_ITEM_WRAPPER,t),a(s.CART_ITEM_IMAGE,t).setAttribute("src",this.item.imageUrl),a(s.CART_ITEM_NAME_LABEL,t).textContent=this.item.label,a(s.CART_ITEM_PRICE_LABEL,t).textContent=r(this.item.price),a(s.CART_ITEM_REMOVE_BUTTON,t).addEventListener("click",this.boundEmitRemoveFn),e.appendChild(t)}detach(){this.containerElementRef&&(a(s.CART_ITEM_REMOVE_BUTTON,this.containerElementRef).removeEventListener("click",this.boundEmitRemoveFn),this.containerElementRef.remove())}emitRemove(e){this.cartStore.remove(e)}}const o=new class{constructor(){this.listeners=new Set,this.items=new Map}add(e){this.items.set(e.label,e),this.emit()}remove(e){this.items.delete(e.label),this.emit()}clear(){this.items.clear(),this.emit()}listen(e){this.listeners.add(e),e(this.getItems())}emit(){const e=this.getItems();Array.from(this.listeners).forEach(t=>{t(e)})}getItems(){return Array.from(this.items.values())}},A=[];return function(){const e=a(s.MASONRY_CONTAINER);n.forEach(t=>{new E(o).render(t,e)})}(),o.listen(e=>function(e){A.forEach(e=>e.detach()),A.splice(0,A.length);let t=0;const n=a(s.CART_ITEMS_CONTAINER);e.forEach(e=>{t+=e.price;const i=new c(e,o);i.render(n),A.push(i)}),a(s.CART_QUANTITY_LABEL).textContent=`(${e.length} item${1===e.length?"":"s"})`,a(s.CART_SUMMARY_LABEL).textContent=r(t)}(e)),e.clearCart=function(){o.clear()},e.toggleSidebar=function(){a(s.CART_SIDEBAR).classList.toggle("opened")},e}({});
